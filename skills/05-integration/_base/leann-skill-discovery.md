# LEANN Skill Discovery æ•´åˆ

> èªç¾©æœå°‹ 79+ skillsï¼Œè‡ªå‹•æ¨è–¦æœ€ç›¸é—œçš„èƒ½åŠ›

## æ¦‚è¿°

LEANN (Learned Embedding Approximate Nearest Neighbors) æ˜¯ä¸€å€‹é«˜æ•ˆçš„æœ¬åœ°å‘é‡è³‡æ–™åº«ï¼Œæä¾›èªç¾©æœå°‹èƒ½åŠ›ã€‚æ•´åˆåˆ° evolve å¾Œï¼ŒCP1 æª¢æŸ¥é»èƒ½è‡ªå‹•æ ¹æ“šä»»å‹™æè¿°æ¨è–¦æœ€ç›¸é—œçš„ skillã€‚

## èˆ‡ç¾æœ‰ç³»çµ±çš„é—œä¿‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Skill æœå°‹æ¶æ§‹                           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ sqlite-memory   â”‚      â”‚ LEANN Index     â”‚              â”‚
â”‚  â”‚ (FTS5 é—œéµå­—)   â”‚      â”‚ (èªç¾©å‘é‡)      â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                        â”‚                        â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                      â”‚                                      â”‚
â”‚                      â–¼                                      â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚           â”‚ CP1: Skill æ¨è–¦     â”‚                          â”‚
â”‚           â”‚ 1. LEANN èªç¾©æœå°‹   â”‚ â† å„ªå…ˆ                   â”‚
â”‚           â”‚ 2. FTS5 é—œéµå­—æœå°‹  â”‚ â† å›é€€                   â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è¨­å®š

### é¦–æ¬¡è¨­å®š

```bash
# åŸ·è¡Œè¨­å®šè…³æœ¬ï¼ˆå®‰è£ LEANN + å»ºç«‹ç´¢å¼•ï¼‰
./scripts/setup-skill-index.sh
```

### æŸ¥çœ‹ç‹€æ…‹

```bash
./scripts/setup-skill-index.sh --status
```

### é‡å»ºç´¢å¼•

```bash
# ç•¶ skill repos æœ‰æ›´æ–°æ™‚
./scripts/setup-skill-index.sh --rebuild
```

### æ¸¬è©¦æœå°‹

```bash
./scripts/setup-skill-index.sh --test
```

## ä½¿ç”¨æ–¹å¼

### è‡ªå‹•ä½¿ç”¨ï¼ˆæ¨è–¦ï¼‰

åŸ·è¡Œ `/evolve` æ™‚ï¼ŒCP1 æª¢æŸ¥é»æœƒè‡ªå‹•ï¼š

1. å¾ä»»å‹™æè¿°æå–é—œéµæ¦‚å¿µ
2. ä½¿ç”¨ LEANN èªç¾©æœå°‹ç›¸é—œ skill
3. é¡¯ç¤ºæ¨è–¦çµæœ

```
ğŸ¯ Skill Discovery (èªç¾©æœå°‹):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. deckbuilder-roguelike (0.92)                    â”‚
â”‚    å¡ç‰Œ Roguelike éŠæˆ²è¨­è¨ˆæ¨¡å¼                     â”‚
â”‚                                                    â”‚
â”‚ 2. flame (0.87)                                    â”‚
â”‚    Flutter 2D éŠæˆ²å¼•æ“é–‹ç™¼                         â”‚
â”‚                                                    â”‚
â”‚ 3. brainstorming (0.71)                            â”‚
â”‚    å‰µæ„ç™¼æƒ³å’Œéœ€æ±‚æ¢ç´¢                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ‰‹å‹•æœå°‹

```bash
# CLI æœå°‹
leann search skills "ä½ çš„ä»»å‹™æè¿°"

# Python API
from leann import LeannSearcher

searcher = LeannSearcher("~/.claude/leann-indexes/skills")
results = searcher.search("å¡ç‰ŒéŠæˆ²é–‹ç™¼", top_k=5)

for r in results:
    print(f"{r.metadata['name']}: {r.score:.2f}")
```

## æœå°‹å„ªå‹¢

| æœå°‹æ–¹å¼ | ç¯„ä¾‹æŸ¥è©¢ | çµæœ |
|---------|---------|------|
| **FTS5 é—œéµå­—** | "card game" | åªæ‰¾åˆ°åŒ…å« "card" æˆ– "game" çš„ skill |
| **LEANN èªç¾©** | "card game" | ä¹Ÿæ‰¾åˆ° "deckbuilder", "roguelike", "tcg" ç›¸é—œ skill |

### èªç¾©ç†è§£ç¯„ä¾‹

```
æŸ¥è©¢: "è™•ç†ç•°æ­¥ç«¶çˆ­æ¢ä»¶"

FTS5 çµæœ: (å¯èƒ½æ‰¾ä¸åˆ°)

LEANN çµæœ:
  1. testing-strategies - åŒ…å«ä½µç™¼æ¸¬è©¦æ¨¡å¼
  2. reliability-engineering - åŒ…å« race condition è™•ç†
  3. python - åŒ…å« asyncio æœ€ä½³å¯¦è¸
```

## ç´¢å¼•å…§å®¹

æ¯å€‹ skill ç´¢å¼•åŒ…å«ï¼š

| æ¬„ä½ | ä¾†æº | ç”¨é€” |
|------|------|------|
| name | SKILL.md frontmatter | è­˜åˆ¥ |
| description | SKILL.md frontmatter | ä¸»è¦èªç¾©åŒ¹é… |
| triggers | SKILL.md frontmatter | é—œéµå­—è£œå…… |
| body | SKILL.md å…§å®¹å‰ 500 å­— | æ·±åº¦èªç¾©åŒ¹é… |
| path | æª”æ¡ˆè·¯å¾‘ | å®šä½ |

## ç´¢å¼•ä½ç½®

```
~/.claude/
â”œâ”€â”€ skill-cache/                    # Skill repos å¿«å–
â”‚   â”œâ”€â”€ claude-software-skills/     # 55 skills
â”‚   â””â”€â”€ claude-domain-skills/       # 24 skills
â”‚
â””â”€â”€ leann-indexes/
    â””â”€â”€ skills/                     # LEANN å‘é‡ç´¢å¼•
```

## é™ç´šæ©Ÿåˆ¶

ç•¶ LEANN ä¸å¯ç”¨æ™‚ï¼Œè‡ªå‹•é™ç´šåˆ° FTS5ï¼š

```python
def search_skills(query: str) -> list:
    # å„ªå…ˆ LEANN
    try:
        from leann import LeannSearcher
        searcher = LeannSearcher("~/.claude/leann-indexes/skills")
        return searcher.search(query, top_k=5)
    except:
        pass

    # å›é€€ FTS5
    return memory_search({"query": f"skill:* {query}", "limit": 5})
```

## æ›´æ–°ç´¢å¼•

### æ‰‹å‹•æ›´æ–°

```bash
# åŒæ­¥æœ€æ–° skill + é‡å»ºç´¢å¼•
./scripts/setup-skill-index.sh --rebuild
```

### è‡ªå‹•æ›´æ–°ï¼ˆå»ºè­°ï¼‰

å°‡ä»¥ä¸‹åŠ å…¥ crontab æˆ–å®šæœŸåŸ·è¡Œï¼š

```bash
# æ¯é€±æ›´æ–°ä¸€æ¬¡
0 0 * * 0 ~/.claude/self-evolving-agent/scripts/setup-skill-index.sh --rebuild
```

## ç›¸é—œè³‡æº

- [LEANN GitHub](https://github.com/yichuan-w/LEANN)
- [sync-skills.sh](../../../scripts/sync-skills.sh) - Skill åŒæ­¥è…³æœ¬
- [CP1 Memory Search](../../02-checkpoints/_base/cp1-memory-search.md) - æª¢æŸ¥é»æ•´åˆ
