# PDCA 執行循環

> Plan → Do → Check → Act 的迭代執行

## 流程圖

```
┌─ Plan（規劃）─────────────────────────────────────────┐
│  - 制定具體執行計劃                                   │
│  - 預測可能的問題                                     │
│  - 準備備選方案                                       │
└───────────────────────────────────────────────────────┘
                          ↓
┌─ Do（執行）───────────────────────────────────────────┐
│  - 按計劃執行                                         │
│  - 記錄執行過程                                       │
│  - 收集中間結果                                       │
└───────────────────────────────────────────────────────┘
                          ↓
┌─ Check（評估）────────────────────────────────────────┐
│  - 結果是否符合預期？                                 │
│  - 如果失敗，分析原因                                 │
│  - 評估：完全成功 / 部分成功 / 失敗                  │
│                                                       │
│  🔑 Boris Tip #13: 給 Claude 驗證工作的方式           │
│     品質提升 2-3 倍                                   │
│                                                       │
│  自動化驗證策略：                                     │
│  □ 執行測試：npm test / pytest / go test             │
│  □ 執行構建：npm run build / tsc / cargo build       │
│  □ Lint 檢查：eslint / prettier --check              │
│  □ 型別檢查：tsc --noEmit                            │
│                                                       │
│  驗證失敗 → 不進入下一步，先修復                      │
└───────────────────────────────────────────────────────┘
                          ↓
┌─ Act（改進）──────────────────────────────────────────┐
│  如果成功：                                           │
│  - 記錄成功經驗到 .claude/memory/learnings/           │
│  - 更新 index.md                                      │
│  - 進入下一個子目標                                   │
│                                                       │
│  如果失敗：                                           │
│  - 反思：為什麼失敗？                                 │
│  - 學習：需要什麼新知識/技能？                       │
│  - 搜索：查找相關資料                                 │
│  - 更新：改進執行策略                                 │
│  - 記錄失敗到 .claude/memory/failures/                │
│  - 重試：帶著新知識重新執行                           │
└───────────────────────────────────────────────────────┘
```

## 失敗模式診斷

失敗時先分類，再針對性處理：

| 類型 | 症狀 | 處方 |
|------|------|------|
| **A: 知識缺口** | 不知道怎麼做 | recommend_skill → install → learn |
| **B: 執行錯誤** | 知道但做錯了 | 重新閱讀文檔、檢查參數 |
| **C: 環境問題** | 依賴缺失、版本不符 | 修復環境、安裝依賴 |
| **D: 策略錯誤** | 方法正確但不適合情境 | 切換到其他策略 |
| **E: 資源限制** | 記憶體不足、API 限制 | 優化資源、分批處理 |

## 多策略機制

不重複嘗試同一個失敗策略：

```
策略選擇邏輯：
1. 從 available_strategies 按 priority 排序
2. 跳過 status = "failed" 的策略
3. 選擇第一個可行的策略
4. 如果所有策略都失敗 → 詢問用戶或搜尋新策略
```

## 反思流程（Reflexion）

每次失敗後：

1. **失敗分析**
   - 錯誤類型是什麼？
   - 根本原因是什麼？

2. **知識補充**
   - 需要學習什麼？
   - 搜索相關資料

3. **策略調整**
   - 原策略哪裡有問題？
   - 新策略是什麼？

4. **記憶更新**
   - 寫入 .claude/memory/
   - 格式：[情境] → [錯誤] → [解決方案]
