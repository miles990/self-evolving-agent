# Checkpoint 6.5: Worktree å®Œæˆ - åˆä½µæˆ–æ¸…ç†

> ğŸ **æ¢ä»¶æ€§æª¢æŸ¥é»** - ä½¿ç”¨ Worktree æ™‚å¿…é ˆåŸ·è¡Œ
>
> ğŸ’¡ **æ ¸å¿ƒè·è²¬**ï¼šæ ¹æ“šä»»å‹™çµæœï¼Œæ­£ç¢ºè™•ç† Worktreeï¼ˆåˆä½µ/æ¸…ç†/ä¿ç•™ï¼‰

## è¦å‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ Worktree å®Œæˆï¼ˆæ¢ä»¶è§¸ç™¼ï¼‰                                    â”‚
â”‚                                                                 â”‚
â”‚  ç•¶ä»»å‹™åœ¨ Worktree ä¸­åŸ·è¡Œå®Œç•¢ï¼Œå¿…é ˆæ­£ç¢ºæ”¶å°¾ï¼š                    â”‚
â”‚                                                                 â”‚
â”‚  è§¸ç™¼æ¢ä»¶ï¼š                                                     â”‚
â”‚  â€¢ CP0.5 å»ºç«‹äº† Worktree                                        â”‚
â”‚  â€¢ ä»»å‹™é”åˆ°çµ‚æ­¢æ¢ä»¶ï¼ˆæˆåŠŸ/å¤±æ•—/æš«åœï¼‰                           â”‚
â”‚                                                                 â”‚
â”‚  è™•ç†æ–¹å¼ï¼ˆä¾ä»»å‹™çµæœï¼‰ï¼š                                        â”‚
â”‚  â€¢ âœ… æˆåŠŸ â†’ åˆä½µåˆ° main + æ¸…ç† Worktree                        â”‚
â”‚  â€¢ âŒ å¤±æ•— â†’ CP5 é©—å± + è¨˜éŒ„æ•™è¨“ + åˆªé™¤ Worktree                â”‚
â”‚  â€¢ â¸ï¸ æš«åœ â†’ ä¿ç•™ Worktree + è¨˜éŒ„ç‹€æ…‹                           â”‚
â”‚                                                                 â”‚
â”‚  âœ… å¿…é ˆï¼šå®Œæˆå¾Œæ¸…ç†è³‡æºï¼Œä¸ç•™æ®˜é¤˜                               â”‚
â”‚  âŒ ç¦æ­¢ï¼šç›´æ¥åˆªé™¤æœ‰æœªæäº¤è®Šæ›´çš„ Worktreeï¼ˆé™¤éæ˜ç¢ºæ”¾æ£„ï¼‰        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## è§¸ç™¼æ¢ä»¶

| æƒ…æ³ | æ˜¯å¦è§¸ç™¼ |
|------|----------|
| ä»»å‹™æˆåŠŸå®Œæˆ | âœ… è§¸ç™¼ï¼ˆåˆä½µæµç¨‹ï¼‰ |
| ä»»å‹™å¤±æ•— | âœ… è§¸ç™¼ï¼ˆæ¸…ç†æµç¨‹ï¼‰ |
| ä»»å‹™æš«åœ | âœ… è§¸ç™¼ï¼ˆä¿ç•™æµç¨‹ï¼‰ |
| æœªä½¿ç”¨ Worktree | âŒ è·³é |

## åŸ·è¡Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CP6.5 åŸ·è¡Œæµç¨‹                               â”‚
â”‚                                                                 â”‚
â”‚              ä»»å‹™é”åˆ°çµ‚æ­¢æ¢ä»¶                                    â”‚
â”‚                       â†“                                         â”‚
â”‚               ä½¿ç”¨äº† Worktree?                                  â”‚
â”‚                       â”‚                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚         â†“                           â†“                           â”‚
â”‚        æ˜¯                          å¦                           â”‚
â”‚         â†“                           â†“                           â”‚
â”‚   åˆ¤æ–·ä»»å‹™çµæœ                   è·³é CP6.5                      â”‚
â”‚         â”‚                           â†“                           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”                  çµæŸæµç¨‹                        â”‚
â”‚    â†“    â†“    â†“                                                  â”‚
â”‚  æˆåŠŸ  å¤±æ•—  æš«åœ                                               â”‚
â”‚    â†“    â†“    â†“                                                  â”‚
â”‚  åˆä½µ  æ¸…ç†  ä¿ç•™                                               â”‚
â”‚  æµç¨‹  æµç¨‹  æµç¨‹                                               â”‚
â”‚    â†“    â†“    â†“                                                  â”‚
â”‚    â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜                                                  â”‚
â”‚         â†“                                                       â”‚
â”‚    æ›´æ–°åŒ—æ¥µæ˜Ÿ                                                   â”‚
â”‚         â†“                                                       â”‚
â”‚    çµæŸæµç¨‹                                                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æˆåŠŸï¼šåˆä½µæµç¨‹

### æ­¥é©Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… ä»»å‹™æˆåŠŸ - åˆä½µæµç¨‹                                         â”‚
â”‚                                                                 â”‚
â”‚  1. ç¢ºèªæ‰€æœ‰è®Šæ›´å·²æäº¤                                          â”‚
â”‚     git status  # æ‡‰è©²æ˜¯ clean                                  â”‚
â”‚                                                                 â”‚
â”‚  2. æ¨é€åˆ†æ”¯åˆ°é ç«¯                                              â”‚
â”‚     git push -u origin feature/{task-id}                        â”‚
â”‚                                                                 â”‚
â”‚  3. å»ºç«‹ä¸¦åˆä½µ PRï¼ˆæ¨è–¦ä½¿ç”¨ --rebaseï¼‰                          â”‚
â”‚     gh pr create --base main --head feature/{task-id}           â”‚
â”‚     gh pr merge --rebase --delete-branch                        â”‚
â”‚                                                                 â”‚
â”‚  4. åˆ‡æ›å›ä¸»ç›®éŒ„ä¸¦åŒæ­¥                                          â”‚
â”‚     cd /path/to/main/project                                    â”‚
â”‚     git pull origin main                                        â”‚
â”‚                                                                 â”‚
â”‚  5. æ¸…ç† Worktree                                               â”‚
â”‚     git worktree remove .worktrees/{task-id}                    â”‚
â”‚     # åˆ†æ”¯å·²è¢« --delete-branch åˆªé™¤                             â”‚
â”‚                                                                 â”‚
â”‚  6. æ›´æ–°åŒ—æ¥µæ˜Ÿ                                                  â”‚
â”‚     æ¨™è¨˜å®Œæˆæ¨™æº–ç‚º [x]                                          â”‚
â”‚     æ›´æ–°å¥åº·æª¢æŸ¥è¨˜éŒ„                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PR åˆä½µç­–ç•¥é¸æ“‡

| ç­–ç•¥ | æŒ‡ä»¤ | æ­·å²æ•ˆæœ | é©ç”¨å ´æ™¯ |
|------|------|----------|----------|
| **Rebaseï¼ˆæ¨è–¦ï¼‰** | `gh pr merge --rebase` | ç·šæ€§æ­·å²ï¼Œç„¡åˆä½µé» | æ—¥å¸¸åŠŸèƒ½é–‹ç™¼ã€å°ä¿®å¾© |
| Squash | `gh pr merge --squash` | å£“ç¸®ç‚ºå–®ä¸€ commit | å¤šå€‹é›¶æ•£ commit éœ€æ•´ç† |
| Merge | `gh pr merge --merge` | ä¿ç•™åˆ†æ”¯æ­·å²+åˆä½µé» | å¤§å‹åŠŸèƒ½éœ€è¿½è¹¤åˆ†æ”¯æ­·å² |

```
Rebase æ•ˆæœï¼ˆç·šæ€§ï¼‰ï¼š          Merge æ•ˆæœï¼ˆæœ‰åˆä½µé»ï¼‰ï¼š

Aâ”€Bâ”€Câ”€Dâ”€E (main)              Aâ”€Bâ”€â”€â”€â”€â”€â”€â”€M (main)
       â†‘                           \   /
    feature                         Câ”€D (feature)
```

> ğŸ’¡ **ç‚ºä½•æ¨è–¦ Rebaseï¼Ÿ**
> - ç”¢ç”Ÿä¹¾æ·¨çš„ç·šæ€§æ­·å²
> - `git log` æ›´æ˜“é–±è®€
> - `git bisect` æ›´æœ‰æ•ˆ
> - æ²’æœ‰å¤šé¤˜çš„åˆä½µ commit

### æŒ‡ä»¤åºåˆ—

```bash
# 1. ç¢ºèªè®Šæ›´å·²æäº¤
cd .worktrees/{task-id}
git status
# è‹¥æœ‰æœªæäº¤è®Šæ›´
git add . && git commit -m "feat: complete {task-description}"

# 2. æ¨é€åˆ°é ç«¯
git push -u origin feature/{task-id}

# 3. å»ºç«‹ PR
gh pr create --base main --head feature/{task-id} \
  --title "feat: {task-description}" \
  --body "## Summary
- {è®Šæ›´æ‘˜è¦}

## Test plan
- [ ] {æ¸¬è©¦é …ç›®}"

# 4. åˆä½µ PRï¼ˆé¸æ“‡ä¸€ç¨®ç­–ç•¥ï¼‰
gh pr merge --rebase --delete-branch     # æ¨è–¦ï¼šç·šæ€§æ­·å²
# gh pr merge --squash --delete-branch   # æ›¿ä»£ï¼šå£“ç¸® commits
# gh pr merge --merge --delete-branch    # æ›¿ä»£ï¼šä¿ç•™åˆ†æ”¯æ­·å²

# 5. åˆ‡æ›å›ä¸»ç›®éŒ„ä¸¦åŒæ­¥
cd /path/to/main/project
# æˆ–
cd $(git worktree list | grep -v ".worktrees" | head -1 | awk '{print $1}')
git pull origin main

# 6. æ¸…ç† Worktree
git worktree remove .worktrees/{task-id}
# æœ¬åœ°åˆ†æ”¯å¯èƒ½å·²è¢«é ç«¯åˆªé™¤åŒæ­¥ï¼Œè‹¥é‚„åœ¨å‰‡æ‰‹å‹•åˆªé™¤
git branch -d feature/{task-id} 2>/dev/null || true

# 7. é©—è­‰
git worktree list  # æ‡‰è©²ä¸å†é¡¯ç¤ºè©² worktree
git branch -a      # ç¢ºèªåˆ†æ”¯å·²æ¸…ç†
```

### ç›´æ¥åˆä½µï¼ˆä¸å»º PRï¼‰

è‹¥å°ˆæ¡ˆä¸éœ€è¦ PR æµç¨‹ï¼Œå¯ç›´æ¥åœ¨æœ¬åœ°åˆä½µï¼š

```bash
# åˆ‡æ›å›ä¸»ç›®éŒ„
cd /path/to/main/project

# ç›´æ¥ mergeï¼ˆæœƒç”¢ç”Ÿåˆä½µé»ï¼‰
git merge feature/{task-id} --no-ff -m "Merge feature/{task-id}: {æè¿°}"

# æˆ– rebase mergeï¼ˆç·šæ€§æ­·å²ï¼‰
git rebase feature/{task-id}

# æ¸…ç†
git worktree remove .worktrees/{task-id}
git branch -d feature/{task-id}
```

### åˆä½µè¡çªè™•ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ åˆä½µè¡çª                                                    â”‚
â”‚                                                                 â”‚
â”‚  åœ¨åˆä½µ feature/{task-id} åˆ° main æ™‚ç™¼ç”Ÿè¡çªï¼š                  â”‚
â”‚                                                                 â”‚
â”‚  è¡çªæª”æ¡ˆï¼š                                                     â”‚
â”‚  â€¢ src/auth/login.ts                                            â”‚
â”‚  â€¢ src/api/routes.ts                                            â”‚
â”‚                                                                 â”‚
â”‚  è™•ç†æ–¹å¼ï¼š                                                     â”‚
â”‚  A) æ‰‹å‹•è§£æ±ºè¡çªï¼ˆæ¨è–¦ï¼‰                                        â”‚
â”‚  B) ä½¿ç”¨ ours ç­–ç•¥ï¼ˆä¿ç•™ mainï¼‰                                 â”‚
â”‚  C) ä½¿ç”¨ theirs ç­–ç•¥ï¼ˆä¿ç•™ featureï¼‰                            â”‚
â”‚  D) æ”¾æ£„åˆä½µï¼Œä¿ç•™ Worktree                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å¤±æ•—ï¼šæ¸…ç†æµç¨‹

### æ­¥é©Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ ä»»å‹™å¤±æ•— - æ¸…ç†æµç¨‹                                         â”‚
â”‚                                                                 â”‚
â”‚  1. åŸ·è¡Œ CP5 å¤±æ•—é©—å±                                           â”‚
â”‚     åˆ†æå¤±æ•—åŸå› ï¼Œè¨˜éŒ„æ•™è¨“                                      â”‚
â”‚                                                                 â”‚
â”‚  2. ç¢ºèªæ˜¯å¦è¦ä¿ç•™ä»»ä½•è®Šæ›´                                      â”‚
â”‚     æœ‰åƒ¹å€¼çš„ç¨‹å¼ç¢¼ï¼Ÿéƒ¨åˆ†æˆåŠŸçš„åŠŸèƒ½ï¼Ÿ                            â”‚
â”‚                                                                 â”‚
â”‚  3. è¨˜éŒ„æ•™è¨“åˆ° Memory                                           â”‚
â”‚     .claude/memory/lessons/{date}-{task-id}.md                  â”‚
â”‚                                                                 â”‚
â”‚  4. å¼·åˆ¶åˆªé™¤ Worktree                                           â”‚
â”‚     git worktree remove .worktrees/{task-id} --force            â”‚
â”‚     git branch -D feature/{task-id}                             â”‚
â”‚                                                                 â”‚
â”‚  5. æ›´æ–°åŒ—æ¥µæ˜Ÿ                                                  â”‚
â”‚     è¨˜éŒ„å¤±æ•—ï¼Œæ›´æ–°å¥åº·æª¢æŸ¥è¨˜éŒ„                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŒ‡ä»¤åºåˆ—

```bash
# 1. åŸ·è¡Œ CP5ï¼ˆåœ¨ worktree å…§ï¼‰
cd .worktrees/{task-id}
# ... CP5 å¤±æ•—é©—å±æµç¨‹ ...

# 2. è‹¥æœ‰éƒ¨åˆ†æœ‰åƒ¹å€¼çš„ç¨‹å¼ç¢¼ï¼Œå…ˆ cherry-pick æˆ– patch
git format-patch main..HEAD -o /tmp/patches/

# 3. åˆ‡æ›å›ä¸»ç›®éŒ„
cd /path/to/main/project

# 4. å¼·åˆ¶åˆªé™¤
git worktree remove .worktrees/{task-id} --force
git branch -D feature/{task-id}

# 5. è‹¥éœ€è¦ä¿ç•™éƒ¨åˆ†è®Šæ›´
git apply /tmp/patches/*.patch  # å¯é¸
```

### å¤±æ•—å¾Œè©¢å•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ ä»»å‹™å¤±æ•—                                                    â”‚
â”‚                                                                 â”‚
â”‚  ä»»å‹™ {task-id} ç„¡æ³•å®Œæˆã€‚                                      â”‚
â”‚                                                                 â”‚
â”‚  å¤±æ•—åŸå› ï¼š{åŸå› æ‘˜è¦}                                           â”‚
â”‚  æ•™è¨“å·²è¨˜éŒ„ï¼š.claude/memory/lessons/{date}-{task-id}.md         â”‚
â”‚                                                                 â”‚
â”‚  Worktree ä¸­æœ‰ 3 å€‹æœªæäº¤çš„è®Šæ›´æª”æ¡ˆï¼š                           â”‚
â”‚  â€¢ src/auth/login.ts (modified)                                 â”‚
â”‚  â€¢ src/utils/helper.ts (new)                                    â”‚
â”‚  â€¢ tests/auth.test.ts (modified)                                â”‚
â”‚                                                                 â”‚
â”‚  ä½ æƒ³è¦ï¼š                                                       â”‚
â”‚  A) ç›´æ¥åˆªé™¤ï¼ˆæ”¾æ£„æ‰€æœ‰è®Šæ›´ï¼‰                                    â”‚
â”‚  B) ä¿ç•™ patches å¾Œåˆªé™¤                                         â”‚
â”‚  C) ä¿ç•™ Worktreeï¼ˆä¹‹å¾Œå†è™•ç†ï¼‰                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æš«åœï¼šä¿ç•™æµç¨‹

### æ­¥é©Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â¸ï¸ ä»»å‹™æš«åœ - ä¿ç•™æµç¨‹                                         â”‚
â”‚                                                                 â”‚
â”‚  1. æäº¤ç•¶å‰é€²åº¦                                                â”‚
â”‚     git add . && git commit -m "WIP: {é€²åº¦æè¿°}"                â”‚
â”‚                                                                 â”‚
â”‚  2. æ¨é€åˆ°é ç«¯ï¼ˆå¯é¸ï¼‰                                          â”‚
â”‚     git push -u origin feature/{task-id}                        â”‚
â”‚                                                                 â”‚
â”‚  3. è¨˜éŒ„æš«åœç‹€æ…‹                                                â”‚
â”‚     æ›´æ–°åŒ—æ¥µæ˜Ÿæ–‡ä»¶ï¼Œè¨˜éŒ„æš«åœåŸå› å’Œæ¢å¾©æ¢ä»¶                      â”‚
â”‚                                                                 â”‚
â”‚  4. é–å®š Worktreeï¼ˆé˜²æ­¢è¢« pruneï¼‰                               â”‚
â”‚     git worktree lock .worktrees/{task-id}                      â”‚
â”‚                                                                 â”‚
â”‚  5. åˆ‡æ›å›ä¸»ç›®éŒ„                                                â”‚
â”‚     cd /path/to/main/project                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŒ‡ä»¤åºåˆ—

```bash
# 1. æäº¤é€²åº¦
cd .worktrees/{task-id}
git add .
git commit -m "WIP: {é€²åº¦æè¿°}

æš«åœåŸå› ï¼š{åŸå› }
æ¢å¾©æ¢ä»¶ï¼š{æ¢ä»¶}"

# 2. æ¨é€ï¼ˆå¯é¸ï¼Œå»ºè­°åšï¼‰
git push -u origin feature/{task-id}

# 3. é–å®š worktree
git worktree lock .worktrees/{task-id} --reason "ä»»å‹™æš«åœï¼š{åŸå› }"

# 4. åˆ‡æ›å›ä¸»ç›®éŒ„
cd /path/to/main/project
```

### æ¢å¾©æš«åœçš„ä»»å‹™

```bash
# è§£é– worktree
git worktree unlock .worktrees/{task-id}

# åˆ‡æ›åˆ° worktree
cd .worktrees/{task-id}

# ç¹¼çºŒåŸ·è¡Œï¼ˆå¾ CP1 é–‹å§‹ï¼‰
```

## å®Œæˆä¿¡è™Ÿ

### æˆåŠŸåˆä½µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… Worktree å®Œæˆ - å·²åˆä½µ                                      â”‚
â”‚                                                                 â”‚
â”‚  ä»»å‹™ï¼š{task-id}                                                â”‚
â”‚  åˆ†æ”¯ï¼šfeature/{task-id} â†’ main                                 â”‚
â”‚  PRï¼š#123                                                       â”‚
â”‚  åˆä½µæ–¹å¼ï¼šrebase (ç·šæ€§æ­·å²)                                    â”‚
â”‚                                                                 â”‚
â”‚  å·²æ¸…ç†ï¼š                                                       â”‚
â”‚  â€¢ Worktree: .worktrees/{task-id}                               â”‚
â”‚  â€¢ æœ¬åœ°åˆ†æ”¯: feature/{task-id}                                  â”‚
â”‚  â€¢ é ç«¯åˆ†æ”¯: origin/feature/{task-id}                           â”‚
â”‚                                                                 â”‚
â”‚  åŒ—æ¥µæ˜Ÿå·²æ›´æ–° âœ“                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¤±æ•—æ¸…ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âŒ Worktree å®Œæˆ - å·²æ¸…ç†                                      â”‚
â”‚                                                                 â”‚
â”‚  ä»»å‹™ï¼š{task-id}                                                â”‚
â”‚  çµæœï¼šå¤±æ•—                                                     â”‚
â”‚  åŸå› ï¼š{å¤±æ•—åŸå› }                                               â”‚
â”‚                                                                 â”‚
â”‚  å·²æ¸…ç†ï¼š                                                       â”‚
â”‚  â€¢ Worktree: .worktrees/{task-id}                               â”‚
â”‚  â€¢ åˆ†æ”¯: feature/{task-id}                                      â”‚
â”‚                                                                 â”‚
â”‚  æ•™è¨“å·²è¨˜éŒ„ï¼š.claude/memory/lessons/{date}-{task-id}.md         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æš«åœä¿ç•™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â¸ï¸ Worktree å®Œæˆ - å·²ä¿ç•™                                      â”‚
â”‚                                                                 â”‚
â”‚  ä»»å‹™ï¼š{task-id}                                                â”‚
â”‚  ç‹€æ…‹ï¼šæš«åœ                                                     â”‚
â”‚  åŸå› ï¼š{æš«åœåŸå› }                                               â”‚
â”‚                                                                 â”‚
â”‚  ä¿ç•™ä¸­ï¼š                                                       â”‚
â”‚  â€¢ Worktree: .worktrees/{task-id} (locked)                      â”‚
â”‚  â€¢ åˆ†æ”¯: feature/{task-id}                                      â”‚
â”‚  â€¢ é ç«¯: origin/feature/{task-id}                               â”‚
â”‚                                                                 â”‚
â”‚  æ¢å¾©æ–¹å¼ï¼šcd .worktrees/{task-id} && git worktree unlock .     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## èˆ‡å…¶ä»–æª¢æŸ¥é»çš„é—œä¿‚

```
CP0 (åŒ—æ¥µæ˜ŸéŒ¨å®š)
     â†“
CP0.5 (Worktree æº–å‚™)
     â†“
CP1 ~ CP6 (åœ¨ Worktree å…§åŸ·è¡Œ)
     â†“
CP6.5 (Worktree å®Œæˆ) â† ä½ åœ¨é€™è£¡
     â”‚
     â”œâ”€â”€ æˆåŠŸ â†’ åˆä½µ + æ¸…ç†
     â”œâ”€â”€ å¤±æ•— â†’ CP5 + æ¸…ç†
     â””â”€â”€ æš«åœ â†’ ä¿ç•™ + é–å®š
```

## ç›¸é—œè³‡æº

- [CP0.5: Worktree æº–å‚™](./cp0.5-worktree-setup.md)
- [CP5: å¤±æ•—é©—å±](./cp5-failure-postmortem.md)
- [éš”é›¢ç’°å¢ƒæ¦‚è¿°](../../06-scaling/_base/isolated-environments.md)
