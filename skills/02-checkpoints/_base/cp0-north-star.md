# Checkpoint 0: 專案/任務開始 - 北極星錨定

> 🌟 **強制檢查點** - 不可跳過
>
> 💡 **核心洞察**：「做到後面，好像都迷失了方向」— 這是專案失敗的常見原因

## 規則

```
┌─────────────────────────────────────────────────────────────────┐
│  🌟 專案/任務開始前（強制）                                      │
│                                                                 │
│  在執行任何複雜任務前，必須先錨定北極星：                        │
│                                                                 │
│  1. 檢查北極星文件是否存在                                      │
│     → .claude/memory/north-star/{project-name}.md               │
│                                                                 │
│  2. 若存在 → 讀取並確認                                         │
│     → 願景還是這個嗎？                                          │
│     → 完成標準有變嗎？                                          │
│                                                                 │
│  3. 若不存在 → 觸發北極星訪談                                   │
│     → 用 AskUserQuestion 收集關鍵資訊                           │
│     → 創建北極星文件                                            │
│                                                                 │
│  ❌ 禁止：大型任務沒有北極星就開始執行                          │
│  ✅ 必須：Level 1/2 任務必須有北極星錨定                        │
└─────────────────────────────────────────────────────────────────┘
```

## 觸發條件

| 任務類型 | 是否觸發 CP0 |
|----------|--------------|
| 架構等級 Level 2（新模組/服務/整合） | ✅ 強制觸發 |
| 架構等級 Level 1（新功能/重構） | ✅ 強制觸發 |
| 架構等級 Level 0（bug fix/小修改） | ❌ 跳過 |
| 專案新建 | ✅ 強制觸發 |
| 繼續未完成的專案 | ✅ 讀取既有北極星 |

## 北極星文件位置

```
.claude/memory/north-star/
├── {project-name}.md          # 專案級北極星
└── {feature-name}.md          # 大型功能級北極星（可選）
```

## 北極星文件模板

```yaml
---
created: {date}
project: "{專案名稱}"
status: active | paused | completed | abandoned
last_checkpoint: {date}
iteration_count: 0
---

# 🌟 北極星：{專案名稱}

## 一句話願景
> [20字內：這個專案存在的理由]

## 完成標準（Done = 什麼？）
- [ ] [可驗證的標準 1]
- [ ] [可驗證的標準 2]
- [ ] [可驗證的標準 3]

## 不做清單（Scope 護欄）
- ❌ [明確排除 1]
- ❌ [明確排除 2]

## 當初為什麼開始？
[1-2句話，迷失時回來看這段]

---

## 健康檢查記錄

| 日期 | 迭代 | 方向 | 備註 |
|------|------|------|------|
| {date} | #1 | ✅ 正軌 | 初始建立 |
```

## 北極星訪談流程

當北極星文件不存在時，使用 AskUserQuestion 進行訪談：

```
┌─────────────────────────────────────────────────────────────────┐
│  🌟 北極星訪談                                                  │
│                                                                 │
│  問題 1：願景（必問）                                           │
│  「用一句話描述：這個專案做完後，你希望達成什麼？」             │
│                                                                 │
│  問題 2：完成標準（必問）                                       │
│  「怎樣算『做完』？請給我 2-3 個可以打勾的標準」                │
│                                                                 │
│  問題 3：排除範圍（必問）                                       │
│  「有什麼是這個專案『不要做』的？」                             │
│  （防止 scope creep）                                           │
│                                                                 │
│  問題 4：動機（必問）                                           │
│  「當初為什麼想做這個？」                                       │
│  （迷失時的提醒）                                               │
│                                                                 │
│  收集完畢 → 生成北極星文件 → 儲存到 .claude/memory/north-star/  │
└─────────────────────────────────────────────────────────────────┘
```

### AskUserQuestion 範例

```
┌─────────────────────────────────────────────────────────────────┐
│  🌟 建立北極星                                                  │
│                                                                 │
│  這是一個 Level 1/2 任務，讓我先幫你錨定方向：                  │
│                                                                 │
│  1. 一句話願景                                                  │
│     這個專案做完後，你希望達成什麼？                            │
│     [________________]                                          │
│                                                                 │
│  2. 完成標準（怎樣算做完？）                                    │
│     □ [標準 1]                                                 │
│     □ [標準 2]                                                 │
│     □ [標準 3]                                                 │
│                                                                 │
│  3. 不做清單（明確排除）                                        │
│     ❌ [排除 1]                                                 │
│     ❌ [排除 2]                                                 │
│                                                                 │
│  4. 當初為什麼想做這個？                                        │
│     [________________]                                          │
└─────────────────────────────────────────────────────────────────┘
```

## CP0 執行流程

```
┌─────────────────────────────────────────────────────────────────┐
│                     CP0 執行流程                                │
│                                                                 │
│                    任務開始                                     │
│                       ↓                                         │
│               判斷架構等級                                       │
│                       ↓                                         │
│         ┌─────────────────────────────┐                         │
│         │ Level 0?                    │                         │
│         └─────────────────────────────┘                         │
│                  ↓ Yes              ↓ No                        │
│              跳過 CP0           繼續 CP0                        │
│                                     ↓                           │
│                          檢查北極星文件                          │
│                                     ↓                           │
│              ┌──────────────────────────────────┐               │
│              │ 存在?                            │               │
│              └──────────────────────────────────┘               │
│                  ↓ Yes                    ↓ No                  │
│           讀取並確認                觸發北極星訪談               │
│                  ↓                        ↓                     │
│        「願景還是這個嗎？」      AskUserQuestion 收集            │
│                  ↓                        ↓                     │
│            更新 last_checkpoint      創建北極星文件             │
│                  ↓                        ↓                     │
│                  └────────────────────────┘                     │
│                              ↓                                  │
│                        進入 CP1                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 為什麼重要

1. **防止迷失方向** - 有明確的錨點可以隨時回顧
2. **防止 Scope Creep** - 「不做清單」是護欄
3. **知道何時結束** - 完成標準是可打勾的 checkbox
4. **迷失時有依靠** - 「當初為什麼開始」提供動力

## Worktree 判斷（v5.1 新增）

CP0 完成後，評估是否需要隔離環境：

```
┌─────────────────────────────────────────────────────────────────┐
│  🔒 Worktree 判斷                                               │
│                                                                 │
│  強制使用 Worktree（任一條件）：                                 │
│  □ 架構等級 Level 2（新模組/服務/整合）                         │
│  □ --autonomous 模式                                            │
│  □ spec-workflow 並行任務                                       │
│  □ 用戶明確要求隔離                                             │
│                                                                 │
│  建議使用 Worktree（任一條件）：                                 │
│  □ 預期執行時間 > 30 分鐘                                       │
│  □ 涉及核心模組修改                                             │
│  □ 實驗性開發（「試試看」「實驗一下」）                          │
│                                                                 │
│  → 符合條件時，進入 CP0.5 建立 Worktree                         │
│  → 否則，直接進入 CP1                                           │
└─────────────────────────────────────────────────────────────────┘
```

詳見 [CP0.5: Worktree 準備](./cp0.5-worktree-setup.md)

## 與其他檢查點的關係

```
CP0 (北極星錨定) → [CP0.5 Worktree?] → CP1 (Memory 搜尋) → ... → CP3 → ... → CP6 → [CP6.5 完成?]
     ↑                                                              │                    │
     └──────────────────────────────────────────────────────────────┴────────────────────┘
                                    讀取北極星進行比對
```
